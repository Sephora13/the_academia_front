<app-sidebar></app-sidebar>


<div *ngIf="loading" class="text-center py-12">
  <i class="fas fa-spinner fa-spin text-2xl text-blue-400"></i>
  <p class="mt-2">Chargement des r√©sultats...</p>
</div>
<main class="main container" id="main" *ngIf="!loading">
  <div class="container">
    <h1 class="composition"><strong>üìö Nouvelles Compositions</strong></h1>

    <div *ngFor="let compo of compositions" class="composition-card">
      <div class="infos">
        <h3>{{ compo.titre }}</h3>
        <p>Date pr√©vue : {{ compo.date | date:'dd/MM/yyyy √† HH:mm' }}</p>
        
        <!-- Messages d'√©tat -->
        <p *ngIf="compo.status === 'active' && compo.canStart" class="active-status">
          ‚úÖ Disponible maintenant
        </p>
        <p *ngIf="compo.status === 'active' && !compo.canStart && !compo.hasExistingCopy" class="inactive-status">
          ‚è≥ Composition d√©sactiv√©e
        </p>
        <p *ngIf="compo.status === 'future'" class="future-status">
          ‚åõ Disponible √† partir de {{ compo.date | date:'dd/MM/yyyy √† HH:mm' }}
        </p>
        
        <!-- Nouveau message pour copie existante -->
        <p *ngIf="compo.hasExistingCopy" class="copied-status">
          üóπ Vous avez d√©j√† compos√© pour cette √©preuve
        </p>
      </div>
      
      <button 
        (click)="lancerComposition(compo.id)" 
        [disabled]="!compo.canStart || compo.hasExistingCopy"
        [class.disabled]="!compo.canStart || compo.hasExistingCopy">
        {{ compo.hasExistingCopy ? 'D√©j√† compos√©' : 'D√©marrer' }}
      </button>
    </div>

    <div *ngIf="compositions.length === 0" class="no-composition">
      Aucune composition pr√©vue pour le moment.
    </div>
  </div>
</main>